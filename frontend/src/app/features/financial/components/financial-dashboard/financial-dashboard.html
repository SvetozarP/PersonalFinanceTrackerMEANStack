<div class="financial-dashboard-container">
    <!-- Header Section -->
    <div class="header-section">
      <div class="title-section">
        <h1>Financial Dashboard</h1>
        <p class="subtitle">Overview of your financial health and recent activity</p>
      </div>
      <div class="header-actions">
        <div class="period-selector">
          <label for="period">Period:</label>
          <select id="period" [(ngModel)]="selectedPeriod" (change)="onPeriodChange(selectedPeriod)" class="form-control">
            <option value="week">This Week</option>
            <option value="month">This Month</option>
            <option value="quarter">This Quarter</option>
            <option value="year">This Year</option>
          </select>
        </div>
        <button class="btn btn-outline-primary" (click)="onRefresh()">
          <i class="fas fa-sync-alt"></i>
          Refresh
        </button>
      </div>
    </div>
  
    <!-- Error Display -->
    <div *ngIf="error" class="alert alert-danger">
      <i class="fas fa-exclamation-triangle"></i>
      {{ error }}
    </div>
  
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="spinner"></div>
      <p>Loading dashboard data...</p>
    </div>
  
    <!-- Dashboard Content -->
    <div *ngIf="!isLoading && dashboard" class="dashboard-content">
      
      <!-- Overview Cards -->
      <div class="overview-section">
        <div class="overview-grid">
          <!-- Total Balance Card -->
          <div class="overview-card balance-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-wallet"></i>
              </div>
              <div class="card-title">Total Balance</div>
            </div>
            <div class="card-value">{{ formatCurrency(getTotalBalance()) }}</div>
            <div class="card-change" [class]="getChangeClass(getMonthlyNet())">
              <span class="change-indicator">{{ getChangeIndicator(getMonthlyNet()) }}</span>
              <span class="change-value">{{ formatCurrency(getMonthlyNet()) }}</span>
              <span class="change-period">this month</span>
            </div>
          </div>
  
          <!-- Monthly Income Card -->
          <div class="overview-card income-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-arrow-down"></i>
              </div>
              <div class="card-title">Monthly Income</div>
            </div>
            <div class="card-value">{{ formatCurrency(getMonthlyIncome()) }}</div>
            <div class="card-subtitle">Total incoming funds</div>
          </div>
  
          <!-- Monthly Expenses Card -->
          <div class="overview-card expense-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-arrow-up"></i>
              </div>
              <div class="card-title">Monthly Expenses</div>
            </div>
            <div class="card-value">{{ formatCurrency(getMonthlyExpenses()) }}</div>
            <div class="card-subtitle">Total outgoing funds</div>
          </div>
  
          <!-- Monthly Net Card -->
          <div class="overview-card net-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-chart-line"></i>
              </div>
              <div class="card-title">Monthly Net</div>
            </div>
            <div class="card-value" [class]="getChangeClass(getMonthlyNet())">
              {{ formatCurrency(getMonthlyNet()) }}
            </div>
            <div class="card-subtitle">Income - Expenses</div>
          </div>
        </div>
      </div>
  
      <!-- Quick Stats Row -->
      <div class="quick-stats-section">
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-icon pending">
              <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value">{{ getPendingTransactionsCount() }}</div>
              <div class="stat-label">Pending Transactions</div>
            </div>
          </div>
  
          <div class="stat-item">
            <div class="stat-icon recurring">
              <i class="fas fa-redo"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value">{{ getUpcomingRecurringCount() }}</div>
              <div class="stat-label">Upcoming Recurring</div>
            </div>
          </div>
  
          <div class="stat-item">
            <div class="stat-icon categories">
              <i class="fas fa-tags"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value">{{ categories.length }}</div>
              <div class="stat-label">Active Categories</div>
            </div>
          </div>
  
          <div class="stat-item">
            <div class="stat-icon transactions">
              <i class="fas fa-receipt"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value">{{ recentTransactions.length }}</div>
              <div class="stat-label">Recent Transactions</div>
            </div>
          </div>
        </div>
      </div>
  
      <!-- Main Dashboard Grid -->
      <div class="dashboard-grid">
        
        <!-- Recent Transactions -->
        <div class="dashboard-card transactions-card">
          <div class="card-header">
            <h3 class="card-title">
              <i class="fas fa-history"></i>
              Recent Transactions
            </h3>
            <button class="btn btn-sm btn-outline-primary" (click)="navigateToTransactions()">
              View All
            </button>
          </div>
          <div class="card-content">
            <div *ngIf="recentTransactions.length === 0" class="empty-state">
              <i class="fas fa-receipt"></i>
              <p>No recent transactions</p>
            </div>
            <div *ngIf="recentTransactions.length > 0" class="transactions-list">
              <div *ngFor="let transaction of recentTransactions" class="transaction-item">
                <div class="transaction-icon" [style.background-color]="getCategoryColor(transaction.categoryId)">
                  <span class="icon">{{ getTransactionTypeIcon(transaction.type) }}</span>
                </div>
                <div class="transaction-details">
                  <div class="transaction-title">{{ transaction.title }}</div>
                  <div class="transaction-meta">
                    <span class="category">{{ getCategoryName(transaction.categoryId) }}</span>
                    <span class="date">{{ formatDate(transaction.date) }}</span>
                  </div>
                </div>
                <div class="transaction-amount" [class]="transaction.type === 'income' ? 'income' : 'expense'">
                  {{ formatCurrency(transaction.amount, transaction.currency) }}
                </div>
                <div class="transaction-status">
                  <span class="status-badge {{ getTransactionStatusClass(transaction.status) }}">
                    {{ transaction.status }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Top Categories -->
        <div class="dashboard-card categories-card">
          <div class="card-header">
            <h3 class="card-title">
              <i class="fas fa-chart-pie"></i>
              Top Spending Categories
            </h3>
            <button class="btn btn-sm btn-outline-primary" (click)="navigateToCategories()">
              Manage
            </button>
          </div>
          <div class="card-content">
            <div *ngIf="getTopCategories().length === 0" class="empty-state">
              <i class="fas fa-chart-pie"></i>
              <p>No category data available</p>
            </div>
            <div *ngIf="getTopCategories().length > 0" class="categories-list">
              <div *ngFor="let category of getTopCategories()" class="category-item">
                <div class="category-color" [style.background-color]="category.color"></div>
                <div class="category-details">
                  <div class="category-name">{{ category.name }}</div>
                  <div class="category-amount">{{ formatCurrency(category.amount) }}</div>
                </div>
                <div class="category-percentage">
                  {{ formatPercentage(category.amount, getMonthlyExpenses()) }}
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Spending Trends -->
        <div class="dashboard-card trends-card">
          <div class="card-header">
            <h3 class="card-title">
              <i class="fas fa-chart-line"></i>
              Spending Trends
            </h3>
            <button class="btn btn-sm btn-outline-primary" (click)="navigateToReports()">
              View Report
            </button>
          </div>
          <div class="card-content">
            <div *ngIf="getSpendingTrends().length === 0" class="empty-state">
              <i class="fas fa-chart-line"></i>
              <p>No trend data available</p>
            </div>
            <div *ngIf="getSpendingTrends().length > 0" class="trends-chart">
              <!-- This would contain a chart component in a real implementation -->
              <div class="chart-placeholder">
                <i class="fas fa-chart-area"></i>
                <p>Chart visualization would go here</p>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Budget Status -->
        <div class="dashboard-card budget-card">
          <div class="card-header">
            <h3 class="card-title">
              <i class="fas fa-bullseye"></i>
              Budget Status
            </h3>
            <button class="btn btn-sm btn-outline-primary" (click)="navigateToReports()">
              View Details
            </button>
          </div>
          <div class="card-content">
            <div *ngIf="getBudgetStatus().length === 0" class="empty-state">
              <i class="fas fa-bullseye"></i>
              <p>No budget data available</p>
            </div>
            <div *ngIf="getBudgetStatus().length > 0" class="budget-list">
              <div *ngFor="let budget of getBudgetStatus()" class="budget-item">
                <div class="budget-category">{{ budget.category }}</div>
                <div class="budget-progress">
                  <div class="progress-bar">
                    <div class="progress-fill" 
                         [style.width.%]="getBudgetProgressPercentage(budget.spent, budget.budget)"
                         [class.over-budget]="budget.spent > budget.budget">
                    </div>
                  </div>
                  <div class="budget-amounts">
                    <span class="spent">{{ formatCurrency(budget.spent) }}</span>
                    <span class="separator">/</span>
                    <span class="budget">{{ formatCurrency(budget.budget) }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <!-- Quick Actions -->
      <div class="quick-actions-section">
        <h3 class="section-title">Quick Actions</h3>
        <div class="actions-grid">
          <button class="action-btn primary" (click)="addTransaction()">
            <div class="action-icon">
              <i class="fas fa-plus"></i>
            </div>
            <div class="action-content">
              <div class="action-title">Add Transaction</div>
              <div class="action-subtitle">Record a new transaction</div>
            </div>
          </button>
  
          <button class="action-btn secondary" (click)="addCategory()">
            <div class="action-icon">
              <i class="fas fa-tag"></i>
            </div>
            <div class="action-content">
              <div class="action-title">Add Category</div>
              <div class="action-subtitle">Create a new category</div>
            </div>
          </button>
  
          <button class="action-btn secondary" (click)="navigateToReports()">
            <div class="action-icon">
              <i class="fas fa-chart-bar"></i>
            </div>
            <div class="action-content">
              <div class="action-title">View Reports</div>
              <div class="action-subtitle">Detailed financial analysis</div>
            </div>
          </button>
  
          <button class="action-btn secondary" (click)="exportData()">
            <div class="action-icon">
              <i class="fas fa-download"></i>
            </div>
            <div class="action-content">
              <div class="action-title">Export Data</div>
              <div class="action-subtitle">Download your financial data</div>
            </div>
          </button>
        </div>
      </div>
    </div>
  
    <!-- Empty State -->
    <div *ngIf="!isLoading && !dashboard" class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-chart-pie"></i>
      </div>
      <h3>No dashboard data available</h3>
      <p>Start by adding some transactions to see your financial overview.</p>
      <button class="btn btn-primary" (click)="addTransaction()">
        <i class="fas fa-plus"></i>
        Add Transaction
      </button>
    </div>
  </div>